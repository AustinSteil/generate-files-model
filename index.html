<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Generator</title>
    <meta name="description" content="Generate Word documents from templates using docxtemplater and PizZip">
    <meta name="author" content="Austin Steil">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Document Generator</h1>
            <p>Generate Word documents using templates and custom data</p>
        </header>

        <main>
            <section class="form-section">
                <h2>Document Information</h2>
                <form id="documentForm">
                    <div class="form-group">
                        <label for="documentTitle">Document Title:</label>
                        <input type="text" id="documentTitle" name="documentTitle" placeholder="Enter document title" required>
                    </div>

                    <div class="form-group">
                        <label for="authorName">Author Name:</label>
                        <input type="text" id="authorName" name="authorName" placeholder="Enter author name" required>
                    </div>

                    <div class="form-group">
                        <label for="documentDate">Date:</label>
                        <input type="date" id="documentDate" name="documentDate" required>
                    </div>

                    <div class="form-group">
                        <label for="documentContent">Content:</label>
                        <textarea id="documentContent" name="documentContent" rows="6" placeholder="Enter document content" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Template File:</label>
                        <div class="template-info">
                            <span>ðŸ“„ template_1.docx</span>
                            <small>Using default template with placeholders</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="previewBtn" class="btn btn-secondary">Preview Data</button>
                        <button type="submit" id="generateBtn" class="btn btn-primary">Generate Document</button>
                    </div>
                </form>
            </section>

            <section class="preview-section" id="previewSection" style="display: none;">
                <h2>Data Preview</h2>
                <div id="previewContent" class="preview-content"></div>
            </section>

            <section class="output-section" id="outputSection" style="display: none;">
                <h2>Generated Document</h2>
                <div id="outputContent" class="output-content">
                    <p>Your document is being generated...</p>
                    <div class="download-area" id="downloadArea" style="display: none;">
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>&copy; 2024 Document Generator - Powered by docxtemplater</p>
        </footer>
    </div>

    <!-- Load docxtemplater and dependencies -->
    <!-- These files are generated by 'npm run setup' from node_modules -->
    <script src="pizzip.js"></script>
    <script src="docxtemplater.js"></script>
    <script>
        // Debug: Verify that required libraries are loaded properly
        window.addEventListener('load', function() {
            console.log('Page loaded. PizZip:', typeof window.PizZip, 'docxtemplater:', typeof window.docxtemplater);
        });
    </script>
    <!-- Main application logic -->
    <script src="main.js"></script>
</body>
</html>